import{h as M,r as d,j as p,F as w,a as e,B as u,S as A,A as D,b,D as I,c as N,T as y,C as L,d as B,e as E,R as T,f as F}from"./vendor.87498e14.js";const R=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}};R();const z=o=>{const t=o?.match(/\[\[(.+?)\]\]/g)?.slice(-1)[0];return M(t?.replaceAll(/^(\[\[)|(\]\])$/g,""),P()?.dateFormatter)},U=o=>{const t=o?.match(/\[\[(.+?)\]\]/g)?.slice(-1)[0];return t?o.replace(t,"").trim():o},$=o=>o?.children?.find(r=>r?.content==="milestones")?.children?.map(r=>{const l=r?.content;return{content:U(l),date:z(l)}}),j=async(o,t)=>logseq.Editor.getBlock(o,t),P=()=>logseq.settings,Y=({uuid:o,forceUpdate:t})=>{const[r,l]=d.exports.useState(),[s,n]=d.exports.useState(!0),[a,v]=d.exports.useState(!1),[f,C]=d.exports.useState(!0);d.exports.useEffect(()=>{(async()=>{const m=await j(o,{includeChildren:!0}),i=$(m);l(i)})()},[o,t]);const k=()=>{n(!s)},h=c=>{v(c)},q=()=>{C(!f)},x=c=>r?.filter(i=>i.date.isSame(c,"day"))?.map((i,S)=>{const O=i.date.isBefore(M(),"day");return e(E,{title:i.content,arrowPointAtCenter:!0,children:e("div",{className:`whitespace-nowrap bg-blue-200 rounded-sm mb-1 ${O?"opacity-50":""}`,children:i.content},i.date.valueOf()+S)})});return p(w,{children:[e("div",{className:"w-screen h-screen absolute bg-transparent",onClick:()=>logseq.hideMainUI()}),p("div",{className:`${a?"w-2/3":"w-1/3"} h-5/6 bg-white absolute top-12 right-4 shadow-lg p-1 overflow-auto rounded transition-all`,children:[e("div",{className:"absolute left-4 top-4",children:a?e(u,{shape:"circle",icon:e(A,{}),onClick:()=>h(!1)}):e(u,{shape:"circle",icon:e(D,{}),onClick:()=>h(!0)})}),p("div",{className:"p-4",children:[e("div",{className:"absolute left-14 top-4",children:e(u,{shape:"circle",icon:s?e(b,{}):e(b,{}),onClick:k})}),e("br",{}),e("div",{className:"absolute left-24 top-4",children:e(u,{shape:"circle",icon:f?e(I,{}):e(N,{}),onClick:q})}),e("br",{}),s?e(w,{children:e(y,{mode:f?"left":"alternate",children:r?.map((c,m)=>e(y.Item,{dot:e(L,{style:{fontSize:"16px"}}),label:c.date.format("YYYY-MM-DD"),children:c.content}))})}):e(B,{dateCellRender:x})]})]})]})};let g=new Map;console.log("[faiz:] === logseq-plugin-milestone loaded"),logseq.ready(()=>{logseq.Editor.registerSlashCommand("milestone",async()=>{const o=await logseq.Editor.getCurrentBlock();!o?.uuid||logseq.Editor.insertAtEditingCursor(`{{renderer milestone-${o.uuid}}}`)}),logseq.setMainUIInlineStyle({position:"fixed",zIndex:11}),logseq.provideModel({show(o){const t=o?.dataset?.faizUuid;V(t,g.get(t)||0),logseq.showMainUI()}}),logseq.App.onMacroRendererSlotted(async({slot:o,payload:t})=>{const r=g.get(t.uuid);if(g.set(t.uuid,r?r+1:1),!/^milestone/.test(t?.arguments?.[0]))return"milestone parse error";logseq.provideUI({key:"milestone",slot:o,reset:!0,template:`<a style="color: var(--ls-link-ref-text-color);" data-on-click="show" data-faiz-uuid="${t?.uuid}">show calender view</a>`})})});function V(o,t){T.render(e(F.StrictMode,{children:e(Y,{uuid:o,forceUpdate:t})}),document.getElementById("root"))}
